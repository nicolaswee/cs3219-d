FROM python:3.7.7-stretch

WORKDIR /app

ADD . /app

#COPY .env ./.env

ARG DB_URL
ARG DRIVER
ARG DB_USERNAME
ARG DB_PASSWORD
ARG DB_PORT
ARG DB_NAME
ARG PASS_SECRET
ARG MSK_BROKER_1
ARG MSK_BROKER_2
ARG REDIS
ARG CELEBRITY_QUEUE_TOPIC
ARG USER_MS

ENV DB_URL=${DB_URL} \
    DRIVER=${DRIVER} \
    DB_USERNAME=${DB_USERNAME} \
    DB_PASSWORD=${DB_PASSWORD} \
    DB_PORT=${DB_PORT} \
    DB_NAME=${DB_NAME} \
    PASS_SECRET=${PASS_SECRET} \
    MSK_BROKER_1=${MSK_BROKER_1} \
    MSK_BROKER_2=${MSK_BROKER_2} \
    REDIS=${REDIS} \
    CELEBRITY_QUEUE_TOPIC=${CELEBRITY_QUEUE_TOPIC} \
    USER_MS=${USER_MS}

RUN pip install -r requirements.txt

CMD ["python", "app.py"]